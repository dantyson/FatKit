!function(t){var o;window.FatKit&&(o=t(FatKit)),"function"==typeof define&&define.amd&&define("fatkit-map",["fatkit"],function(){return o||t(FatKit)})}(function(t){"use strict";t.component("map",{defaults:{map_type:"road",map_options:{draggable:!0,mapTypeControl:!0,navigationControl:!0,overviewMapControl:!1,panControl:!0,rotateControl:!0,scaleControl:!0,scrollwheel:!0,streetViewControl:!0,zoomControl:!0},lat:0,lng:0,zoom:12,marker:!1,animation:!0,markers:[]},boot:function(){t.ready(function(o){t.$("[data-f-map]",o).each(function(){var o=t.$(this);if(!o.data("map")){t.map(o,t.Utils.options(o.attr("data-f-map")))}})})},init:function(){if("object"==typeof google&&"object"==typeof google.maps)this.SetupMap();else{var t=document.createElement("script");t.src="//maps.google.com/maps/api/js?sensor=false&callback=NoMapLoaded",document.body.appendChild(t)}},SetupMap:function(){var o=google.maps.MapTypeId.ROADMAP;switch(this.options.map_type){case"satellite":o=google.maps.MapTypeId.SATELLITE;break;case"hybrid":o=google.maps.MapTypeId.HYBRID;break;case"terrain":o=google.maps.MapTypeId.TERRAIN}var e={zoom:this.options.zoom,center:new google.maps.LatLng(this.options.lat,this.options.lng),mapTypeId:o};t.$.extend(e,this.options.map_options),this.objMap=new google.maps.Map(this.element[0],e),this.objBounds=new google.maps.LatLngBounds,this.options.marker?(this.options.marker.lat=this.options.lat,this.options.marker.lng=this.options.lng,this.AddMarker(this.options.marker)):this.AddMarkers()},SetupStreetView:function(){this.objStreetView=this.objMap.getStreetView(),this.objStreetView.setPosition(new google.maps.LatLng(this.options.lat,this.options.lng)),this.objStreetView.setPov({heading:34,pitch:10}),this.objStreetView.setVisible(!0)},SetupDirections:function(){this.objDirections=new google.maps.DirectionsService,this.objDirectionsRender=new google.maps.DirectionsRenderer,this.objDirectionsRender.setMap(this.objMap),this.objDirectionsRender.setPanel(this.objContainer[0])},AddMarker:function(t){var o=new google.maps.LatLng(t.lat,t.lng);this.objBounds.extend(o);var e=new google.maps.Marker({position:o,map:this.objMap,title:t.title,animation:this.options.animation?google.maps.Animation.DROP:null});this.arrMarkers||(this.arrMarkers=[]),this.arrMarkers.push(e);this.arrMarkers.length-1;if(t.infowindow){var i=t.infowindow,n=this;google.maps.event.addListener(e,"click",function(){var t=n.GetInfoWindow('<div class="f-map-infowindow-title">'+i.title+'</div><div class="f-map-infowindow-content">'+i.content+"</div>");t.open(n.objMap,e)})}},AddMarkers:function(){if(this.options.markers&&this.options.markers.length>0){for(var t=0,o=this.options.markers.length;o>t;t++)this.AddMarker(this.options.markers[t]);this.objMap.fitBounds(this.objBounds);var e=this;google.maps.event.addListenerOnce(this.objMap,"idle",function(){google.maps.event.trigger(e.objMap,"resize"),e.objMap.fitBounds(e.objBounds)}),this.element.trigger("complete.f.map",[this])}},ReloadMap:function(){google.maps.event.trigger(this.objMap,"resize"),this.objMap.setCenter(new google.maps.LatLng(this.options.lat,this.options.lng))},ReloadStreetView:function(){google.maps.event.trigger(this.objPano,"resize")},CalculateDirections:function(t,o){this.objDirections||this.SetupDirections();var e={origin:t,destination:o,travelMode:google.maps.DirectionsTravelMode.DRIVING},i=this;this.objDirections.route(e,function(t,o){o===google.maps.DirectionsStatus.OK&&i.objDirectionsRender.setDirections(t)})},GetInfoWindow:function(t){return this.objInfoWindow||(this.objInfoWindow=new google.maps.InfoWindow({maxWidth:450})),this.objInfoWindow.setContent(t),this.objInfoWindow}})}),window.NoMapLoaded=function(){$("[data-f-map]").data("map").boot()};